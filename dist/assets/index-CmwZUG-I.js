import{createNoise2D as E}from"https://cdn.jsdelivr.net/npm/simplex-noise@4.0.1/+esm";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(t){if(t.ep)return;t.ep=!0;const i=n(t);fetch(t.href,i)}})();class T{constructor(e,n=256){this.canvas=e,this.ctx=e.getContext("2d"),this.size=n,this.canvas.width=n,this.canvas.height=n,this.landTypes={deepOcean:{color:"#1a1a3a",heightRange:[0,.3],noiseScale:.8,noiseWeight:.3},shallowOcean:{color:"#2a2a5a",heightRange:[.3,.5],noiseScale:.6,noiseWeight:.4},beach:{color:"#e6b873",heightRange:[.5,.6],noiseScale:.4,noiseWeight:.5},plains:{color:"#4d8c57",heightRange:[.6,.7],noiseScale:.3,noiseWeight:.6},hills:{color:"#6d9c67",heightRange:[.7,.8],noiseScale:.2,noiseWeight:.7},mountains:{color:"#8c6d4d",heightRange:[.8,.9],noiseScale:.15,noiseWeight:.8},snowPeaks:{color:"#f5f5f5",heightRange:[.9,1],noiseScale:.1,noiseWeight:.9}}}getLandType(e){for(const[n,s]of Object.entries(this.landTypes))if(e>=s.heightRange[0]&&e<s.heightRange[1])return{type:n,...s};return null}generate(e=.5){const n=E(),s=this.size/2,t=this.size/2-2;this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.size,this.size);for(let o=0;o<this.size;o++)for(let h=0;h<this.size;h++){const f=h-s,u=o-s,d=Math.sqrt(f*f+u*u);if(d<=t){const m=Math.atan2(u,f),r=Math.cos(m)*d/t,c=Math.sin(m)*d/t,b=1-d/t,x=n(r*e*.5,c*e*.5),v=n(r*e,c*e)*.5,O=n(r*e*2,c*e*2)*.25,z=n(r*e*4,c*e*4)*.125,L=n(r*e*8,c*e*8)*.0625,W=n(r*e*.25,c*e*.25)*.3,M=(x+v+O+z+L)/1.9375,N=n(r*e*16,c*e*16)*.05;let a=b+(M+N+W)*.5;for(const[B,l]of Object.entries(this.landTypes))if(a>=l.heightRange[0]&&a<l.heightRange[1]){const P=n(r*e*l.noiseScale,c*e*l.noiseScale)*l.noiseWeight*.2;a+=P;break}a=Math.max(0,Math.min(1,a));const y=this.getLandType(a);y&&(this.ctx.fillStyle=y.color,this.ctx.fillRect(h,o,1,1))}}const i=this.ctx.createRadialGradient(s,s,t*.8,s,s,t);i.addColorStop(0,"rgba(255, 255, 255, 0.1)"),i.addColorStop(1,"rgba(255, 255, 255, 0)"),this.ctx.fillStyle=i,this.ctx.fillRect(0,0,this.size,this.size)}}const w=document.getElementById("planetCanvas"),p=new T(w),R=document.getElementById("noiseScale"),I=document.getElementById("randomize");p.generate();I.addEventListener("click",()=>{p.generate(parseFloat(R.value))});R.addEventListener("input",g=>{p.generate(parseFloat(g.target.value))});
